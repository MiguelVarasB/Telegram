{% if view_type == 'files' %}
    <div class="section-title">
        <span id="results-title">Videos mostrados: {{ "{:,}".format(items|length)|replace(",", ".") }}</span>
       
        {% if pagination is defined and pagination %}
        <div class="sort-controls">
            <form method="get" action="{{ pagination.base_path }}">
                <input type="hidden" name="page" value="{{ pagination.page }}">
                <input type="hidden" name="per_page" value="{{ pagination.per_page }}">
                <input type="hidden" name="direction" value="{{ pagination.direction }}">
                <label for="sort">Ordenar por:</label>
                <select name="sort" id="sort" onchange="this.form.submit()">
                    <option value="fecha" {% if pagination.sort == 'fecha' %}selected{% endif %}>Fecha</option>
                    <option value="nombre" {% if pagination.sort == 'nombre' %}selected{% endif %}>Nombre</option>
                    <option value="duracion" {% if pagination.sort == 'duracion' %}selected{% endif %}>Duración</option>
                </select>
                <select name="direction" onchange="this.form.submit()">
                    <option value="desc" {% if pagination.direction == 'desc' %}selected{% endif %}>Desc</option>
                    <option value="asc" {% if pagination.direction == 'asc' %}selected{% endif %}>Asc</option>
                </select>
                <select name="thumb_filter" onchange="this.form.submit()">
                    <option value="con" {% if pagination.thumb_filter == 'con' %}selected{% endif %}>Con thumb</option>
                    <option value="sin" {% if pagination.thumb_filter == 'sin' %}selected{% endif %}>Sin thumb</option>
                    <option value="todos" {% if pagination.thumb_filter == 'todos' %}selected{% endif %}>Todos</option>
                </select>
            </form>
        </div>
        {% endif %}
    </div>
{% else %}
    <div class="section-title results-title-bar">
        <span id="results-title">Contenido</span>
        {% if current_folder_id is defined %}
        <div class="sort-controls" style="margin-left:16px; display:flex; align-items:center; gap:8px;">
            <form method="get" action="{{ current_folder_url or '' }}" style="display:flex; align-items:center; gap:8px;">
                <label for="sort-folder">Ordenar por:</label>
                <select name="sort" id="sort-folder" onchange="this.form.submit()">
                    <option value="faltantes" {% if current_sort == 'faltantes' %}selected{% endif %}>Faltantes</option>
                    <option value="indexados" {% if current_sort == 'indexados' %}selected{% endif %}>Indexados</option>
                    <option value="totales" {% if current_sort == 'totales' %}selected{% endif %}>Totales</option>
                    <option value="nombre" {% if current_sort == 'nombre' %}selected{% endif %}>Nombre</option>
                    <option value="fecha_scan" {% if current_sort == 'fecha_scan' %}selected{% endif %}>Fecha scan</option>
                    <option value="ultimo_msg" {% if current_sort == 'ultimo_msg' %}selected{% endif %}>Último mensaje</option>
                    <option value="completos" {% if current_sort == 'completos' %}selected{% endif %}>Completos primero</option>
                </select>
                <select name="direction" onchange="this.form.submit()">
                    <option value="desc" {% if current_direction == 'desc' %}selected{% endif %}>Desc</option>
                    <option value="asc" {% if current_direction == 'asc' %}selected{% endif %}>Asc</option>
                </select>
            </form>
        </div>
        {% endif %}
        <div id="limites" style="display:inline-flex; display:none" class="results-limit-control">
            <label for="search-limit">Límite</label>
            <input
                type="number"
                id="search-limit"
                name="limit"
                min="1"
                max="10000"
                value="20"
                step="100"
                inputmode="numeric"
            >
        </div>
        <button type="button" id="btn-sync-faltantes" class="btn-sync" style="margin-left:auto; display:none">
            Sincronizar faltantes
        </button>
    </div>
{% endif %}

{% if pagination is defined and pagination %}
    <div class="pagination-bar">
        <div class="pagination-info">
            Página {% if pagination.page_fmt is defined %}{{ pagination.page_fmt }}{% else %}{{ pagination.page }}{% endif %}
            de {% if pagination.total_pages_fmt is defined %}{{ pagination.total_pages_fmt }}{% else %}{{ pagination.total_pages }}{% endif %}

            {% if pagination.total_items_fmt is defined %}
                <span class="pagination-muted">(Total: {{ pagination.total_items_fmt }})</span>
            {% elif pagination.total_items is defined %}
                <span class="pagination-muted">(Total: {{ pagination.total_items }})</span>
            {% endif %}
        </div>
        <div class="pagination-actions">
            {% if pagination.has_prev %}
                <a class="pagination-btn" href="{{ pagination.base_path }}?page={{ pagination.prev_page }}&per_page={{ pagination.per_page }}{{ pagination.query_suffix }}">Anterior</a>
            {% else %}
                <span class="pagination-btn is-disabled">Anterior</span>
            {% endif %}

            <div class="pagination-pages">
                {% for p in pagination.pages %}
                    {% if p is none %}
                        <span class="pagination-ellipsis">…</span>
                    {% elif p == pagination.page %}
                        <span class="pagination-btn is-current">{{ p }}</span>
                    {% else %}
                        <a class="pagination-btn" href="{{ pagination.base_path }}?page={{ p }}&per_page={{ pagination.per_page }}{{ pagination.query_suffix }}">{{ p }}</a>
                    {% endif %}
                {% endfor %}
            </div>

            {% if pagination.has_next %}
                <a class="pagination-btn" href="{{ pagination.base_path }}?page={{ pagination.next_page }}&per_page={{ pagination.per_page }}{{ pagination.query_suffix }}">Siguiente</a>
            {% else %}
                <span class="pagination-btn is-disabled">Siguiente</span>
            {% endif %}
        </div>
    </div>
{% endif %}

<div class="grid-view">
    {% for item in items %}
        {% if item.type == 'video' %}
            {% include 'partials/card_video.html' %}
        {% else %}
            {# Asumimos que si no es video, es carpeta o chat #}
            {% include 'partials/card_folder.html' %}
        {% endif %}
    {% endfor %}
</div>

Vista de los videos